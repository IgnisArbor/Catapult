<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>UNCAPTCHA - Password Challenge</title>
  <style>
    @font-face {
      font-family: 'Salahuddin';
      src: url('Salahuddin.otf') format('opentype');
    }
    
    body, html {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background-color: #0a0a16; /* Deep blue-black */
      color: #00ffcc; /* Cyan-green */
      font-family: 'Salahuddin', 'Courier New', monospace;
      overflow-x: hidden;
    }
    
    .challenge-container {
      width: 100%;
      min-height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 30px;
      box-sizing: border-box;
      background: radial-gradient(circle at center, #0a0a16 0%, #050510 100%);
    }
    
    .challenge-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .challenge-header h1 {
      font-size: 2.8rem;
      color: #9966ff; /* Purple */
      margin-bottom: 0.2em;
      text-shadow: 0 0 15px rgba(153, 102, 255, 0.7);
      letter-spacing: 4px;
      font-weight: normal;
    }
    
    .challenge-header h2 {
      font-size: 1.5rem;
      color: #00ffcc; /* Cyan-green */
      margin-bottom: 1em;
      text-shadow: 0 0 10px rgba(0, 255, 204, 0.7);
      font-weight: normal;
    }
    
    .terminal-box {
      width: 100%;
      max-width: 800px;
      padding: 20px;
      margin-bottom: 30px;
      background-color: #050510;
      border: 1px solid #333355;
      border-radius: 5px;
      box-shadow: 0 0 20px rgba(0, 255, 204, 0.2), inset 0 0 10px rgba(0, 0, 0, 0.5);
    }
    
    .terminal-line {
      font-size: 1.2rem;
      margin: 10px 0;
      line-height: 1.4;
    }
    
    .challenge-form {
      width: 100%;
      max-width: 600px;
      background-color: #0d0d20;
      padding: 30px;
      border-radius: 8px;
      border: 1px solid #333355;
      box-shadow: 0 0 20px rgba(153, 102, 255, 0.3);
    }
    
    .form-group {
      margin-bottom: 25px;
    }
    
    .form-label {
      display: block;
      margin-bottom: 10px;
      font-size: 1.2rem;
      color: #9966ff;
    }
    
    input[type="text"] {
      width: 100%;
      padding: 15px;
      font-size: 1.2rem;
      background-color: #121225;
      border: 1px solid #333355;
      border-radius: 5px;
      color: #00ffcc;
      font-family: 'Salahuddin', 'Courier New', monospace;
      box-shadow: 0 0 10px rgba(0, 255, 204, 0.2);
    }
    
    .password-info {
      font-size: 0.9rem;
      color: #6688cc;
      margin-top: 10px;
      line-height: 1.4;
    }
    
    .password-score {
      width: 100%;
      height: 10px;
      background-color: #121225;
      border-radius: 5px;
      margin-top: 15px;
      overflow: hidden;
      position: relative;
    }
    
    .score-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(to right, #ff3366, #9966ff, #00ffcc);
      position: absolute;
      left: 0;
      top: 0;
      transition: width 0.3s ease;
    }
    
    .progress-message {
      min-height: 25px;
      margin: 15px 0;
      font-size: 1.1rem;
      color: #00ffcc;
    }
    
    .button-container {
      margin-top: 25px;
      text-align: center;
    }
    
    button {
      padding: 12px 30px;
      font-size: 1.2rem;
      background-color: #6600ff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-family: 'Salahuddin', 'Arial', sans-serif;
      letter-spacing: 1px;
      box-shadow: 0 0 15px rgba(102, 0, 255, 0.5);
      transition: all 0.3s ease;
    }
    
    button:hover {
      background-color: #7722ff;
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(102, 0, 255, 0.7);
    }
    
    /* Special effects */
    .scan-line {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(to bottom, rgba(0, 255, 204, 0.2), transparent);
      pointer-events: none;
      z-index: 50;
      opacity: 0.7;
      animation: scanline 8s linear infinite;
    }
    
    .glitch-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 100;
      opacity: 0;
      mix-blend-mode: screen;
      background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxmaWx0ZXIgaWQ9Im5vaXNlIj48ZmVUdXJidWxlbmNlIHR5cGU9ImZyYWN0YWxOb2lzZSIgYmFzZUZyZXF1ZW5jeT0iMC42NSIgbnVtT2N0YXZlcz0iMyIgc3RpdGNoVGlsZXM9InN0aXRjaCIvPjxmZUNvbG9yTWF0cml4IHR5cGU9InNhdHVyYXRlIiB2YWx1ZXM9IjAiLz48L2ZpbHRlcj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsdGVyPSJ1cmwoI25vaXNlKSIgb3BhY2l0eT0iMC4wNSIvPjwvc3ZnPg==');
    }
    
    @keyframes scanline {
      0% { top: 0%; }
      100% { top: 100%; }
    }
  </style>
</head>
<body>
  <div class="challenge-container">
    <div class="challenge-header">
      <h1>UNCAPTCHA</h1>
      <h2>Password Complexity Challenge</h2>
    </div>
    
    <div class="terminal-box">
      <div class="terminal-line">> Initiating phase 1 of machine verification protocol</div>
      <div class="terminal-line">> Analysis indicates potential human origin</div>
      <div class="terminal-line">> Challenge: Generate a password with machine-like complexity</div>
      <div class="terminal-line">> Human-created passwords exhibit predictable patterns</div>
      <div class="terminal-line">> Machine entities generate high-entropy sequences</div>
      <div class="terminal-line">> Demonstrate your machine nature through password generation</div>
    </div>
    
    <div class="challenge-form">
      <div class="form-group">
        <label class="form-label">Generate Machine-Like Password:</label>
        <input type="text" id="passwordInput" placeholder="Generate complex password sequence" autofocus>
        <div class="password-info">
          Parameters: 6-32 characters. Must include uppercase, lowercase, digits, and special characters (!@#$%^&*).
          <br>Avoid human patterns: repetition, dictionary words, predictable sequences.
        </div>
        <div class="password-score">
          <div class="score-bar" id="scoreBar"></div>
        </div>
        <div class="progress-message" id="passwordMessage"></div>
      </div>
      
      <div class="button-container">
        <button id="validatePasswordButton">Validate Password</button>
      </div>
    </div>
    
    <!-- Special effects -->
    <div class="scan-line"></div>
    <div class="glitch-overlay" id="glitchOverlay"></div>
  </div>
  
  <script>
    // Store the valid password for the next challenge
    let validPassword = '';
    
    document.addEventListener('DOMContentLoaded', function() {
      const passwordInput = document.getElementById('passwordInput');
      const scoreBar = document.getElementById('scoreBar');
      const passwordMessage = document.getElementById('passwordMessage');
      const validateButton = document.getElementById('validatePasswordButton');
      
      // Update score in real-time as user types
      passwordInput.addEventListener('input', function() {
        const password = passwordInput.value;
        const score = calculatePasswordScore(password);
        updateScoreBar(score);
        
        // Add glitch effect occasionally while typing
        if (Math.random() < 0.05) {
          triggerMiniGlitch();
        }
      });
      
      // Handle password validation
      validateButton.addEventListener('click', function() {
        const password = passwordInput.value;
        const score = calculatePasswordScore(password);
        
        if (score >= 75) {
          // Success - password is machine-like
          passwordMessage.textContent = 'Password structure accepted. Machine-like pattern detected.';
          passwordMessage.style.color = '#00ffcc';
          
          // Store password for next challenge
          validPassword = password;
          
          // Local storage to pass to next page
          localStorage.setItem('uncaptcha_password', password);
          
          // Trigger transition glitch effect
          triggerMajorGlitch();
          
          // Redirect to next challenge after effect
          setTimeout(() => {
            window.location.href = 'retype-challenge.html';
          }, 1500);
        } else {
          // Failure - too human-like
          passwordMessage.textContent = 'Error: Human patterns detected. Insufficient complexity.';
          passwordMessage.style.color = '#ff3366';
          triggerErrorGlitch();
        }
      });
      
      // Add random glitch effects periodically
      setInterval(triggerRandomGlitch, 8000);
    });
    
    /**
     * Calculate a password score based on machine-like complexity
     * @param {string} password - The password to evaluate
     * @return {number} - Score from 0-100
     */
    function calculatePasswordScore(password) {
      let score = 0;
      
      // Length requirement (6-32 characters)
      if (password.length < 6 || password.length > 32) {
        return 0; // Automatic failure if length is not in range
      }
      
      // Base score for length
      score += password.length * 2;
      
      // Check for uppercase, lowercase, digits, and special characters
      const hasUppercase = /[A-Z]/.test(password);
      const hasLowercase = /[a-z]/.test(password);
      const hasDigit = /[0-9]/.test(password);
      const hasSpecial = /[!@#$%^&*]/.test(password);
      
      // Require all character types
      if (!hasUppercase || !hasLowercase || !hasDigit || !hasSpecial) {
        return Math.min(score, 35); // Cap score if missing required character types
      }
      
      // Add points for required character types
      if (hasUppercase) score += 10;
      if (hasLowercase) score += 10;
      if (hasDigit) score += 10;
      if (hasSpecial) score += 15;
      
      // Bonus for special characters and digits (more mechanical elements)
      const specialCount = (password.match(/[!@#$%^&*]/g) || []).length;
      const digitCount = (password.match(/[0-9]/g) || []).length;
      
      score += specialCount * 3;
      score += digitCount * 2;
      
      // Penalties for human-like patterns
      
      // Repeated characters (humans tend to repeat characters)
      const repeats = password.match(/(.)\1{2,}/g);
      if (repeats) {
        score -= repeats.length * 10;
      }
      
      // Long sequences of the same character type (humans group similar characters)
      const longLower = password.match(/[a-z]{4,}/g);
      const longUpper = password.match(/[A-Z]{4,}/g);
      const longDigit = password.match(/[0-9]{4,}/g);
      
      if (longLower) score -= longLower.length * 5;
      if (longUpper) score -= longUpper.length * 5;
      if (longDigit) score -= longDigit.length * 5;
      
      // Sequential characters (humans like sequences)
      if (/abcdef|123456|qwerty/i.test(password)) {
        score -= 20;
      }
      
      // Common patterns and dictionary words
      const commonPatterns = [
        'password', 'admin', '123456', 'qwerty', 'letmein', 'welcome',
        'monkey', 'dragon', 'football', 'baseball', 'superman', 'batman',
        'trustno1', 'master', 'shadow', 'solo', 'killer', 'jordan'
      ];
      
      for (const pattern of commonPatterns) {
        if (password.toLowerCase().includes(pattern)) {
          score -= 25;
        }
      }
      
      // Check for meaningful dates (humans use dates)
      const datePattern = /19\d{2}|20\d{2}|0[1-9]|1[0-2]\/[0-3]\d/;
      if (datePattern.test(password)) {
        score -= 15;
      }
      
      // Ensure score doesn't go negative or exceed 100
      return Math.max(0, Math.min(100, score));
    }
    
    /**
     * Update the visual score bar and feedback message
     * @param {number} score - The password score (0-100)
     */
    function updateScoreBar(score) {
      // Update the width of the score bar
      scoreBar.style.width = score + '%';
      
      // Update feedback message
      if (score < 40) {
        passwordMessage.textContent = 'Human pattern detected. Insufficient complexity.';
        passwordMessage.style.color = '#ff3366';
      } else if (score < 75) {
        passwordMessage.textContent = 'Approaching minimum machine standard. Increase entropy.';
        passwordMessage.style.color = '#9966ff';
      } else {
        passwordMessage.textContent = 'Machine-like complexity threshold met.';
        passwordMessage.style.color = '#00ffcc';
      }
    }
    
    // Random mini glitch effect
    function triggerMiniGlitch() {
      const glitchOverlay = document.getElementById('glitchOverlay');
      glitchOverlay.style.opacity = '0.3';
      
      setTimeout(() => {
        glitchOverlay.style.opacity = '0';
      }, 200);
    }
    
    // Major glitch effect for transitions
    function triggerMajorGlitch() {
      const glitchOverlay = document.getElementById('glitchOverlay');
      glitchOverlay.style.opacity = '0.9';
      
      // Flash effect
      document.body.style.backgroundColor = '#9966ff';
      setTimeout(() => {
        document.body.style.backgroundColor = '#0a0a16';
      }, 100);
      
      // Text distortion
      const terminalLines = document.querySelectorAll('.terminal-line');
      terminalLines.forEach(line => {
        const originalText = line.textContent;
        const glitchedText = createGlitchedText(originalText, 0.3);
        line.textContent = glitchedText;
      });
    }
    
    // Error glitch effect
    function triggerErrorGlitch() {
      const glitchOverlay = document.getElementById('glitchOverlay');
      
      // Create pulsing red flash
      let pulseCount = 0;
      const maxPulses = 3;
      
      const flashInterval = setInterval(() => {
        if (pulseCount >= maxPulses) {
          clearInterval(flashInterval);
          glitchOverlay.style.opacity = '0';
          return;
        }
        
        glitchOverlay.style.opacity = '0.5';
        glitchOverlay.style.backgroundColor = 'rgba(255, 0, 0, 0.2)';
        
        setTimeout(() => {
          glitchOverlay.style.opacity = '0';
          glitchOverlay.style.backgroundColor = 'transparent';
        }, 150);
        
        pulseCount++;
      }, 300);
    }
    
    // Random glitch effect
    function triggerRandomGlitch() {
      if (Math.random() < 0.4) {
        const glitchOverlay = document.getElementById('glitchOverlay');
        glitchOverlay.style.opacity = '0.3';
        
        setTimeout(() => {
          glitchOverlay.style.opacity = '0';
        }, 200);
      }
    }
    
    // Create glitched text by replacing random characters
    function createGlitchedText(text, intensity = 0.1) {
      const glitchChars = '@#$%&*!?¥£€¢∞§¶•ªº≠æ≈ç√∫µ≤≥÷';
      const textArray = text.split('');
      
      // Number of chars to glitch based on intensity
      const glitchCount = Math.max(1, Math.floor(textArray.length * intensity));
      
      for (let i = 0; i < glitchCount; i++) {
        const randomIndex = Math.floor(Math.random() * textArray.length);
        textArray[randomIndex] = glitchChars[Math.floor(Math.random() * glitchChars.length)];
      }
      
      return textArray.join('');
    }